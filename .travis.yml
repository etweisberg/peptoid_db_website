language: python
python:
    - "3.8"

services:
    - docker

install:
    - pip install -r databank/requirements.txt
    - echo 'c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFDQVFEU1kxVlVKNWlKbWJjOGFFSWVhSmhFYjEwN1ovMytBYW45VE1OM0VJK05weXlzdlFmWlZ3MDUwdE4rICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaEVkQXc4YWhlWmdIc1lLOWJiQm14a0I1RkVNU3FYbVNCWU1kdjN5a3hsbGV0ZDJDN3J6Q010UEhJTlh2a2VKV1dnd3hVOFZkaVB5QlhqdFVDaEcyNGNKRnlielBqc1VvQ0RlM3dpU2VLZS94UFF4eldaNHBDcjZNeFFJSzE3YmNJM2lydkhNUVlCTWlTNE5zOStLZlYvICAgICAgICAgICAgICAgICAgICAgRUFIWjhVc21RODMwZFhZYTY0YjhWall5UmhJYVFQZ3hBQytjUHNqeElWS24zRU9NdVZaeGNqYnJPZE5ZSzdBQjFMQUxRb1p5c0VLYkgydWZtSExBdGZyb0dDV0RQVE5lRGU1aE5aTkh3MUJjTm96Mis5cDdrSUQvcjljbkNPOXpOdkUyTkdSYkhiUkszTnlISGZ6bERDeHdoZ0JPdXMzbWcvICAgICAgICAgQUVnOFdWd2t0VmZIWE9QT2pxOERzRmJTQnVIanN5YUtrQmhGa3ZjMG9xYTlDdmZIVVNxZlZSTVdJc3pZK1RnY3JocGdaN1JTMUZ5b3k1Z0hGSEMyeDdMOG1WSkVBbmlhS29sbTNabzVCUzZaSGlkbVBMUEZ0bUR2UHRtTHluR2ExaTdDaGw2bEVCa2lCVmxPRHRUZWV2Y2lCLyAgICAgICAgICAgICAgICAgVDVRckw0S0VYYWlWdzd5V21ITUFUdTV0NXpncDBrOTRaY0xVUWNXY3g3TUt6VHArdjdITWQ1TjFnZ1ZnaU82Y1QrREozSFpUOU04OWorUDlPSjQyODBLWDZXaFdXamozSUlkU3RuWjl5Tlhmd000aWc0b3lzL3JqeEVSZy9rc0VFd0I4TjBzWDBwS0RhY21SM3NkYzJ4WHE3WmNrdmFiUT09ICAgICAgICAgZXdlaXNiZXJnMTBARXRoYW5zLUFpci5maW9zLXJvdXRlci5ob21lCg==' | base64 -d >> $HOME/.ssh/known_hosts
script: pytest -q databank/tests.py

deploy:
  # Build Docker container and push to Docker Hub
  provider: script
  script: bash deploy.sh
  on:
    branch: master
